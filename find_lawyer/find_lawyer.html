<html> 
  <head>
    <title>Find a Lawyer in India | Verified Legal Experts Near You</title> 
    <link rel="icon" href="/images/favicon.png" type="image/png">
    <meta name="description" content="Search for verified lawyers across India for cyber, civil, criminal, family, property, and business legal matters. Get connected with the right expert.">
    <meta name="keywords" content="find a lawyer India, verified lawyers, legal expert, civil lawyer, criminal lawyer, property lawyer">
    <link rel="stylesheet" href="/css/style.css">
    <style>
      body {
        font-family: aptos;
        background-color: rgb(230, 235, 241);
        cursor: default;
        padding: 0;
      }
      h1 {
        text-align: center;
      }
      .controls {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 20px;
      }
      .controls input, .controls select {
        padding: 8px;
        font-size: 16px;
      }
      .lawyer-grid {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        padding: 0 20px;
      }
      
      @media (max-width: 1200px) {
        .card {
          flex: 1 1 calc(33.33% - 20px);
          max-width: calc(33.33% - 20px);
        }
      }
      
      @media (max-width: 768px) {
        .card {
          flex: 1 1 calc(50% - 20px);
          max-width: calc(50% - 20px);
        }
      }
      
      @media (max-width: 480px) {
        .card {
          flex: 1 1 100%;
          max-width: 100%;
        }
      }
      
      .card {
        background-color: rgba(117, 236, 247, 0.589);
        border-radius: 24px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        padding: 16px;
        text-align: center;
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        min-height: 350px;
      }

      .button-group {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
      }
      
      .button-group button {
        background: #d9534f;
        border: none;
        color: white;
        padding: 6px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
      }
      
      .card .contact-now {
        background: #28a745;
      }

      .card img {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
        margin: 0 auto 10px;
        transition: transform 0.3s ease;
      }
      .card img:hover {
        transform: scale(2.2);
        z-index: 10;
      }
      .card button {
        margin-top: 10px;
        background: #d9534f;
        border: none;
        color: white;
        padding: 6px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
      }
      .pagination {
        text-align: center;
        margin: 40px 0; /* add bottom spacing */
      }
      .pagination button {
        margin: 0 5px;
        padding: 5px 10px;
      }
    </style>
  </head>
  <body> 
    <header>
      <div id="nav-placeholder"></div>
      <script>
        fetch("../src/menu.html")
          .then(response => response.text())
          .then(data => {
            document.getElementById("nav-placeholder").innerHTML = data;
          });
      </script>
    </header>
    <br>
    <div class="text-container-frontface">
      <span class="blinking-red">
        <h1>Find a Lawyer</h1>
      </span>
    </div>
    <br>
    <div class="controls">
      <input type="text" id="search" placeholder="Search by name or city">
      <select id="sort">
        <option value="">Sort by</option>
        <option value="name">Name</option>
        <option value="city">City</option>
      </select>
    </div>
    <div class="lawyer-grid" id="lawyerGrid"></div>
    <div class="pagination" id="pagination"></div>

    <script>
      const scriptURL = 'https://script.google.com/macros/s/AKfycbx8BCy2A6uUlAy7KRssKH3_uHJRHsQVn6jLd0URGNFIdRi16tILQwdOC9Xx0sX1cv2HJQ/exec';
      let lawyers = [];
      let filtered = [];
      let currentPage = 1;
      const pageSize = 8;

      async function fetchData() {
        const res = await fetch(scriptURL);
        lawyers = await res.json();

        // Move featured lawyers to top
        lawyers.sort((a, b) => {
          if (a.featured === "TRUE" && b.featured !== "TRUE") return -1;
          if (a.featured !== "TRUE" && b.featured === "TRUE") return 1;
          return 0;
        });

        filtered = [...lawyers];
        render();
      }

      function render() {
        const grid = document.getElementById("lawyerGrid");
        grid.innerHTML = "";
        const start = (currentPage - 1) * pageSize;
        const pageItems = filtered.slice(start, start + pageSize);

        pageItems.forEach(l => {
          const card = document.createElement("div");
          card.className = "card" + (l.featured ? " featured" : "");

          const verifiedBadge = l.verified
            ? '<span class="verified-badge">✔ Verified</span>'
            : '';

          const testimonial = l.testimonials
            ? `<div class="testimonial">“${l.testimonials.split(';')[0].trim()}”</div>`
            : '';

          console.log(l.name, "Verified:", l.verified);

          card.innerHTML = `
            <img src="${l.photo}" alt="photo">
            <h3>${l.name} ${verifiedBadge}</h3>
            <p>${l.city}</p>
            <p>${l.phone}</p>
            ${testimonial}
            <div class="button-group">
              <button class="contact-now" onclick="contactNow('${l.phone}')">Contact Now</button>
              <button onclick="deleteLawyer('${l.phone}')">Delete</button>
            </div>
          `;

          grid.appendChild(card);
        });

        renderPagination();
      }

      function renderPagination() {
        const totalPages = Math.ceil(filtered.length / pageSize);
        const pagination = document.getElementById("pagination");
        pagination.innerHTML = "";
        for (let i = 1; i <= totalPages; i++) {
          const btn = document.createElement("button");
          btn.textContent = i;
          if (i === currentPage) btn.style.fontWeight = "bold";
          btn.onclick = () => { currentPage = i; render(); };
          pagination.appendChild(btn);
        }
      }

      function deleteLawyer(phone) {
        const code = prompt("Enter Admin Code to delete:");
        if (!code) return;
        fetch(`${scriptURL}?phone=${phone}&code=${encodeURIComponent(code)}`, {
          method: 'DELETE'
        }).then(r => r.text()).then(msg => {
          if (msg === "DELETED") {
            alert("Deleted successfully");
            lawyers = lawyers.filter(l => l.phone !== phone);
            filtered = filtered.filter(l => l.phone !== phone);
            render();
          } else {
            alert("Delete failed: " + msg);
          }
        });
      }

      function contactNow(phone) {
        alert("Please call or WhatsApp the lawyer at: " + phone);
        // Optional: redirect to a contact page or trigger modal
      }

      document.getElementById("search").addEventListener("input", e => {
        const q = e.target.value.toLowerCase();
        filtered = lawyers.filter(l => l.name.toLowerCase().includes(q) || l.city.toLowerCase().includes(q));
        currentPage = 1;
        render();
      });

      document.getElementById("sort").addEventListener("change", e => {
        const val = e.target.value;
        if (val === "name") filtered.sort((a, b) => a.name.localeCompare(b.name));
        if (val === "city") filtered.sort((a, b) => a.city.localeCompare(b.city));
        render();
      });

      fetchData();
    </script>


    <script type="text/javascript">
      function googleTranslateElementInit() {
        new google.translate.TranslateElement({
          pageLanguage: 'en',
          includedLanguages: 'en,hi,es,fr,de',
          layout: google.translate.TranslateElement.InlineLayout.SIMPLE
        }, 'google_translate_element');
      }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <script>
      const scrollmenu = document.getElementById("scrollmenu");
      const offsetTop = scrollmenu.offsetTop;

      window.addEventListener("scroll", function () {
        if (window.pageYOffset >= offsetTop) {
          scrollmenu.classList.add("fixed");
        } else {
          scrollmenu.classList.remove("fixed");
        }
      });
    </script>
  </body>
</html>
